<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Result</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 to-black min-h-screen flex flex-col items-center py-10 px-4 font-sans">

  <div class="bg-white p-8 rounded-3xl shadow-2xl text-center w-full max-w-md mb-10 transition-transform hover:scale-105">
    <h1 class="text-3xl font-black mb-2 text-gray-800 tracking-tight">üéâ QUIZ DONE!</h1>
    <p class="text-gray-500 mb-6 font-medium">Performance Summary</p>

    <div class="bg-blue-50 border-2 border-blue-100 py-6 rounded-2xl mb-6">
      <p id="score-display" class="text-5xl font-black text-blue-600">0/0</p>
      <p id="percent-display" class="text-xl font-bold text-blue-400 mt-2">0% Accuracy</p>
    </div>

    <div class="grid grid-cols-1 gap-3">
      <a href="dashboard.html" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg transition text-center">Play Again</a>
      <a href="leaderboard.html" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg transition text-center">Leaderboard</a>
    </div>
  </div>

  <div class="w-full max-w-2xl bg-gray-800 rounded-3xl shadow-2xl overflow-hidden border border-gray-700">
    <div class="bg-gray-700 px-8 py-5 border-b border-gray-600 flex justify-between items-center">
      <h2 class="text-xl font-bold text-white flex items-center gap-2">
        <span>üìù</span> Question Review
      </h2>
      <span class="text-xs text-gray-400 bg-gray-900/50 px-3 py-1 rounded-full border border-gray-600">Scroll to see more</span>
    </div>
    
    <div id="review-container" class="p-6 space-y-4 max-h-[600px] overflow-y-auto custom-scrollbar">
      <p class="text-center text-gray-400 py-10 italic">Processing your results...</p>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // 1. Fetching data from LocalStorage
      const score = localStorage.getItem("score") || 0;
      const rawReviewData = localStorage.getItem("quizReview");
      const reviewData = rawReviewData ? JSON.parse(rawReviewData) : [];
      const total = reviewData.length || 0;
      
      // 2. Displaying the Score
      const scoreDisplay = document.getElementById("score-display");
      const percentDisplay = document.getElementById("percent-display");
      
      scoreDisplay.innerText = ${score} / ${total};
      const percent = total > 0 ? Math.round((score / total) * 100) : 0;
      percentDisplay.innerText = ${percent}% Accuracy;

      const reviewContainer = document.getElementById("review-container");
      
      if (reviewData.length === 0) {
        reviewContainer.innerHTML = <p class="text-center text-gray-400 py-10">No review data available. Please finish a quiz first.</p>;
        return;
      }

      reviewContainer.innerHTML = "";

      // 3. Generating Review Cards
      reviewData.forEach((item, i) => {
        let bgClass, icon, answerTextColor, statusLabel;
        
        // Correct vs Wrong vs Skipped Logic
        if (item.skipped) {
          bgClass = 'bg-yellow-900/10 border-yellow-800/40';
          icon = '‚è≠Ô∏è';
          answerTextColor = 'text-yellow-400';
          statusLabel = 'Skipped';
        } else if (item.isCorrect) {
          bgClass = 'bg-green-900/10 border-green-800/40';
          icon = '‚úÖ';
          answerTextColor = 'text-green-400';
          statusLabel = 'Correct';
        } else {
          bgClass = 'bg-red-900/10 border-red-800/40';
          icon = '‚ùå';
          answerTextColor = 'text-red-400';
          statusLabel = 'Incorrect';
        }

        // Logic to ensure text is never empty
        const userSelectedText = item.selectedText || "Not Answered";
        const actualCorrectText = item.correctText || "Unknown Answer";

        const card = `
          <div class="p-5 border-2 rounded-2xl ${bgClass} transition-all duration-300 hover:bg-opacity-20">
            <div class="flex justify-between items-start gap-4">
              <div class="space-y-1">
                <span class="text-[10px] font-bold uppercase tracking-widest ${answerTextColor}">${statusLabel}</span>
                <p class="font-bold text-white text-lg leading-tight">${i + 1}. ${item.question}</p>
              </div>
              <span class="text-2xl filter drop-shadow-md">${icon}</span>
            </div>
            
            <div class="mt-5 flex flex-wrap gap-4 text-sm">
              <div class="bg-black/40 px-4 py-2 rounded-xl border border-white/5 flex-1 min-w-[140px]">
                <span class="text-gray-500 uppercase text-[10px] block font-bold mb-1">Your Selection</span>
                <span class="${answerTextColor} font-bold text-base leading-tight block">${userSelectedText}</span>
              </div>
              
              ${(!item.isCorrect || item.skipped) ? `
              <div class="bg-green-500/10 px-4 py-2 rounded-xl border border-green-500/20 flex-1 min-w-[140px]">
                <span class="text-green-600 uppercase text-[10px] block font-bold mb-1">Correct Answer</span>
                <span class="text-green-400 font-bold text-base leading-tight block">${actualCorrectText}</span>
              </div>` : ''}
            </div>
          </div>
        `;
        reviewContainer.innerHTML += card;
      });
    });
  </script>

  <style>
    /* Custom Scrollbar */
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #6366f1; }
    
    /* Animation for better feel */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #review-container > div { animation: fadeIn 0.4s ease forwards; }
  </style>
</body>
</html>
